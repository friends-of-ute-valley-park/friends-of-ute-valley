---
import Layout from "@layouts/Layout.astro";
import Card from "@components/Card.astro";
import LeaveNoTrace from "@components/LeaveNoTrace.astro";
import EngagementPanel from "@components/EngagementPanel.astro";
import EmailForm from "@components/EmailForm.vue";

import ChevronRightIcon from "~icons/heroicons/chevron-right";
import { Image, Picture } from "astro:assets";
import heroImage from "../assets/images/ute-valley-park-hero.jpg";
import heroImage2 from "../assets/images/ute-valley-park-hero-2.jpg";
import heroImage3 from "../assets/images/ute-valley-park-hero-3.jpg";
import cta from "../assets/images/volunteer-5.jpg";

import { getCollection } from "astro:content";
import trailConditions from "../data/trail-conditions/trail-conditions.json";
const publishedNewsEntries = await getCollection("news", ({ data }) => {
  return data.published === true;
});

const winterTips = [
  {
    id: "01",
    title: "Stay on Marked Trails",
    description:
      "Stick to visible paths to protect dormant vegetation and avoid disturbing wildlife habitats.",
    tag: "VEGETATION PROTECTION",
  },
  {
    id: "02",
    title: "Dress in Layers",
    description:
      "Colorado weather changes quickly. Bring layers, waterproof footwear, and traction devices.",
    tag: "SAFETY FIRST",
  },
  {
    id: "03",
    title: "Respect Wildlife",
    description:
      "Winter is stressful for animals. Keep dogs leashed and give wildlife extra space.",
    tag: "HABITAT PRESERVATION",
  },
  {
    id: "04",
    title: "Pack Out Everything",
    description:
      "Even in snow, please carry out all trash and pet waste. Frozen waste thaws in spring.",
    tag: "WASTE MGMT",
  },
];
---

<Layout title="Home">
  <main
    class="bg-stone-50 text-stone-950 selection:bg-accent/30 selection:text-primary-dark"
  >
    <!-- Hero Section: The Field Report -->
    <section class="relative border-b border-stone-300 overflow-hidden">
      <!-- Background Grid Overlay -->
      <div
        class="absolute inset-0 bg-grid-subtle opacity-40 pointer-events-none"
      >
      </div>

      <div
        class="relative mx-auto max-w-(--breakpoint-2xl) px-4 sm:px-6 lg:px-8"
      >
        <div class="grid grid-cols-1 lg:grid-cols-12 gap-0">
          <!-- Left Column: Identity & Action -->
          <div
            class="lg:col-span-8 pt-12 pb-20 lg:pt-32 lg:pb-40 border-r border-stone-300 pr-0 lg:pr-12"
          >
            <div class="space-y-8">
              <div class="flex items-center gap-4">
                <span class="inline-block h-px w-12 bg-primary-dark"></span>
                <span
                  class="font-mono text-xs font-bold tracking-widest uppercase text-stone-500"
                >
                  Park Update â€” Feb 2026
                </span>
              </div>

              <h1
                class="text-7xl sm:text-9xl font-serif font-black tracking-tighter leading-[0.85] text-stone-900 uppercase"
              >
                Ute <br /> Valley <br />
                <span class="text-primary-dark">Park.</span>
              </h1>

              <p
                class="max-w-xl text-xl sm:text-2xl font-medium leading-relaxed text-stone-700"
              >
                A 550-acre urban wildland in Colorado Springs. We are the
                stewards dedicated to its preservation, maintenance, and
                community education.
              </p>

              <div class="flex flex-wrap gap-4 pt-4">
                <a
                  href="/visit/"
                  class="group relative px-8 py-4 bg-primary-dark text-white font-mono text-sm font-bold uppercase transition-all hover:bg-stone-900 active:scale-95 shadow-[4px_4px_0px_0px_var(--color-accent)]"
                >
                  <span class="relative z-10 flex items-center gap-2">
                    Plan Visit <ChevronRightIcon
                      class="w-4 h-4 transition-transform group-hover:translate-x-1"
                    />
                  </span>
                </a>
                <a
                  href="/volunteer/"
                  class="group relative px-8 py-4 border-2 border-primary-dark bg-transparent text-primary-dark font-mono text-sm font-bold uppercase transition-all hover:bg-primary/5 active:scale-95"
                >
                  Volunteer
                </a>
              </div>
            </div>
          </div>

          <!-- Right Column: Live Bulletin (Status Dashboard) -->
          <div class="lg:col-span-4 bg-stone-100/50 p-8 lg:p-12">
            <div class="sticky top-24 space-y-12">
              <div>
                <h2
                  class="font-mono text-xs font-black uppercase tracking-widest text-primary-dark mb-6 border-b border-stone-300 pb-2"
                >
                  Current Park Status
                </h2>
                <ul class="space-y-6">
                  <li class="flex justify-between items-start gap-4">
                    <span
                      class="font-mono text-sm text-stone-500 uppercase tracking-tighter"
                      >Current Season</span
                    >
                    <span
                      class="font-mono text-sm font-bold text-right text-stone-900"
                      >WINTER (DORMANT)</span
                    >
                  </li>
                  <li>
                    <div class="flex justify-between items-start gap-4">
                      <span
                        class="font-mono text-sm text-stone-500 uppercase tracking-tighter"
                        >Trail Conditions</span
                      >
                      <span
                        class="font-mono text-sm font-bold text-right text-accent-dark underline decoration-2 underline-offset-4"
                        >{trailConditions.status.toUpperCase()}</span
                      >
                    </div>
                    {
                      trailConditions.message && (
                        <p class="font-mono text-[10px] text-stone-500 mt-1 leading-snug text-right">
                          {trailConditions.message}
                        </p>
                      )
                    }
                  </li>
                  <li class="flex justify-between items-start gap-4">
                    <span
                      class="font-mono text-sm text-stone-500 uppercase tracking-tighter"
                      >Winter Park Hours</span
                    >
                    <span class="font-mono text-sm font-bold text-right"
                      >5AM to 9PM</span
                    >
                  </li>
                  <li class="flex justify-between items-start gap-4">
                    <span
                      class="font-mono text-sm text-stone-500 uppercase tracking-tighter"
                      >Dog Policy</span
                    >
                    <span
                      class="font-mono text-sm font-bold text-right text-primary-dark"
                      >LEASH REQUIRED</span
                    >
                  </li>
                </ul>
              </div>

              <div class="pt-8 border-t border-stone-300">
                <div
                  class="aspect-square bg-stone-200 overflow-hidden relative group border border-stone-300"
                >
                  <Picture
                    src={heroImage}
                    formats={["avif", "webp"]}
                    width="400"
                    height="400"
                    alt="Scenic view"
                    class="object-cover w-full h-full transition-all duration-700 scale-110 group-hover:scale-100"
                  />
                  <div
                    class="absolute inset-0 border-[16px] border-white/30 pointer-events-none"
                  >
                  </div>
                  <div
                    class="absolute bottom-4 left-4 bg-primary-dark text-white px-2 py-1 font-mono text-[10px] uppercase tracking-tighter"
                  >
                    REF: PIKES_PEAK_VIEW_01.JPG
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </section>

    <!-- Visual Interlude: The Landscape -->
    <section
      class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 border-b border-stone-300"
    >
      <div
        class="aspect-video lg:aspect-square border-r border-stone-300 overflow-hidden relative group"
      >
        <Picture
          src={heroImage2}
          formats={["avif", "webp"]}
          width="800"
          height="800"
          alt="Trail"
          class="w-full h-full object-cover transition-transform duration-1000 group-hover:scale-105"
        />
        <div
          class="absolute bottom-4 left-4 bg-white/90 px-3 py-1 font-mono text-xs uppercase border border-stone-200 text-primary-dark font-bold"
        >
          Trail System Access
        </div>
      </div>
      <div
        class="aspect-video lg:aspect-square border-r border-stone-300 overflow-hidden relative group hidden md:block"
      >
        <Picture
          src={heroImage3}
          formats={["avif", "webp"]}
          width="800"
          height="800"
          alt="Vista"
          class="w-full h-full object-cover transition-transform duration-1000 group-hover:scale-105"
        />
        <div
          class="absolute bottom-4 left-4 bg-white/90 px-3 py-1 font-mono text-xs uppercase border border-stone-200 text-primary-dark font-bold"
        >
          Peak Vista Point
        </div>
      </div>
      <div
        class="aspect-video lg:aspect-square overflow-hidden relative group hidden lg:block"
      >
        <Picture
          src={cta}
          formats={["avif", "webp"]}
          width="800"
          height="800"
          alt="Volunteer"
          class="w-full h-full object-cover transition-transform duration-1000 group-hover:scale-105"
        />
        <div
          class="absolute bottom-4 left-4 bg-white/90 px-3 py-1 font-mono text-xs uppercase border border-stone-200 text-primary-dark font-bold"
        >
          Active Stewardship
        </div>
      </div>
    </section>

    <!-- Winter Stewardship: Technical Guidelines -->
    <section class="py-24 border-b border-stone-300">
      <div class="mx-auto max-w-(--breakpoint-2xl) px-4 sm:px-6 lg:px-8">
        <div class="mb-16">
          <h2
            class="text-4xl sm:text-6xl font-serif font-black uppercase tracking-tight text-stone-900 mb-6"
          >
            Winter <span class="text-primary-dark italic">Essentials.</span>
          </h2>
          <p class="max-w-2xl text-lg text-stone-600 font-medium">
            Maintaining park integrity during the dormant season requires
            precise community adherence to stewardship guidelines.
          </p>
        </div>

        <div
          class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-px bg-stone-300 border border-stone-300"
        >
          {
            winterTips.map((tip) => (
              <div class="bg-stone-50 p-8 space-y-6 flex flex-col justify-between hover:bg-white transition-colors group">
                <div class="space-y-4">
                  <span class="font-mono text-4xl font-black text-accent-dark group-hover:text-accent transition-colors">
                    {tip.id}
                  </span>
                  <h3 class="text-xl font-bold font-serif uppercase tracking-tight text-stone-900 group-hover:text-primary-dark transition-colors">
                    {tip.title}
                  </h3>
                  <p class="text-sm leading-relaxed text-stone-600">
                    {tip.description}
                  </p>
                </div>
                <div class="pt-6">
                  <span class="inline-block px-2 py-1 bg-primary-dark text-white font-mono text-[10px] uppercase tracking-widest">
                    {tip.tag}
                  </span>
                </div>
              </div>
            ))
          }
        </div>
      </div>
    </section>

    <!-- Stats Section: Redesigned in place -->
    <section class="py-24 bg-stone-900 text-white">
      <div class="mx-auto max-w-(--breakpoint-2xl) px-4 sm:px-6 lg:px-8">
        <div class="grid grid-cols-1 lg:grid-cols-2 gap-16 items-center">
          <div>
            <span
              class="font-mono text-xs font-bold uppercase tracking-[0.3em] text-stone-300 mb-4 block"
              >Our Impact: 2024</span
            >
            <h2
              class="text-5xl sm:text-7xl font-serif font-black uppercase tracking-tighter leading-none mb-8"
            >
              Our <br />
              <span class="text-primary-light">Impact.</span>
            </h2>
            <p class="text-stone-300 text-lg max-w-md leading-relaxed">
              Quantifiable metrics reflecting our commitment to the Ute Valley
              ecosystem and community engagement.
            </p>
          </div>
          <div
            class="grid grid-cols-2 gap-8 border-l border-stone-800 pl-8 lg:pl-16"
          >
            {
              [
                { label: "Volunteers", value: "130" },
                { label: "Field Hours", value: "538" },
                { label: "Community", value: "1,900" },
                { label: "Surveyed", value: "105" },
              ].map((stat) => (
                <div class="space-y-1">
                  <div class="text-4xl sm:text-6xl font-mono font-black tracking-tighter text-white group-hover:text-accent transition-colors">
                    {stat.value}
                  </div>
                  <div class="text-[10px] font-mono uppercase tracking-widest text-stone-300">
                    {stat.label}
                  </div>
                </div>
              ))
            }
          </div>
        </div>
      </div>
    </section>

    <!-- News Section: The Bulletin Board -->
    <section class="py-24 border-b border-stone-300">
      <div class="mx-auto max-w-(--breakpoint-2xl) px-4 sm:px-6 lg:px-8">
        <div
          class="flex flex-col md:flex-row md:items-end justify-between gap-8 mb-16"
        >
          <div>
            <h2
              class="text-4xl sm:text-6xl font-serif font-black uppercase tracking-tight text-stone-900 mb-4"
            >
              Latest <span class="text-primary-dark italic">Dispatches.</span>
            </h2>
            <p class="text-stone-600 font-medium">
              Internal news and community updates regarding park operations.
            </p>
          </div>
          <a
            href="/news"
            class="font-mono text-sm font-bold uppercase underline decoration-accent decoration-2 underline-offset-8 hover:text-primary transition-colors"
          >
            View All Dispatches
          </a>
        </div>

        <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-12">
          {
            publishedNewsEntries
              .sort(
                (a, b) =>
                  new Date(b.data.publishedOn).getTime() -
                  new Date(a.data.publishedOn).getTime(),
              )
              .slice(0, 3)
              .map((post) => (
                <a href={`/news/${post.id}`} class="group space-y-6">
                  <div class="aspect-16/10 overflow-hidden bg-stone-200 border border-stone-300 relative">
                    <Picture
                      src={post.data.coverImage}
                      formats={["avif", "webp"]}
                      width="600"
                      height="400"
                      alt={post.data.title}
                      class="w-full h-full object-cover transition-transform duration-700 group-hover:scale-105"
                    />
                    <div class="absolute top-4 right-4 bg-primary-dark text-white px-2 py-1 font-mono text-[10px] uppercase">
                      {new Date(post.data.publishedOn).toLocaleDateString(
                        "en-US",
                        { month: "short", day: "2-digit", year: "numeric" },
                      )}
                    </div>
                  </div>
                  <div class="space-y-3">
                    <h3 class="text-2xl font-serif font-bold leading-tight group-hover:text-primary-dark transition-colors">
                      {post.data.title}
                    </h3>
                    <p class="text-sm text-stone-600 line-clamp-2 leading-relaxed">
                      {post.data.previewText}
                    </p>
                  </div>
                </a>
              ))
          }
        </div>
      </div>
    </section>

    <!-- Engagement: Direct Action -->
    <section class="py-24 bg-stone-100">
      <div class="mx-auto max-w-7xl px-4 sm:px-6 lg:px-8">
        <div
          class="bg-white border-2 border-primary-dark p-8 md:p-16 shadow-[16px_16px_0px_0px_var(--color-accent)] relative overflow-hidden"
        >
          <!-- Decorative Background element -->
          <div
            class="absolute top-0 right-0 w-64 h-64 bg-primary/5 -translate-y-1/2 translate-x-1/2 rotate-45 border border-primary-dark/10"
          >
          </div>

          <div
            class="relative z-10 grid grid-cols-1 lg:grid-cols-2 gap-16 items-center"
          >
            <div class="space-y-8">
              <h2
                class="text-4xl sm:text-5xl font-serif font-black uppercase tracking-tight text-stone-900"
              >
                Support the <br />
                <span class="text-primary-dark">Ute Valley Wildland.</span>
              </h2>
              <p class="text-lg text-stone-600 leading-relaxed">
                Your contributions directly fund trail restoration, invasive
                species management, and educational programming. Join our
                network of digital and physical stewards.
              </p>
              <div class="flex flex-wrap gap-4">
                <a
                  href="/donate/"
                  class="px-8 py-4 bg-primary-dark text-white font-mono text-sm font-bold uppercase transition-all hover:bg-stone-900 active:scale-95"
                >
                  Make Donation
                </a>
              </div>
            </div>
            <div class="bg-stone-50 p-8 border border-stone-200">
              <h3
                class="font-mono text-xs font-black uppercase tracking-widest text-primary-dark mb-6 border-b border-stone-200 pb-2"
              >
                Newsletter Subscription
              </h3>
              <EmailForm client:idle />
              <p
                class="mt-4 text-[10px] font-mono text-stone-500 uppercase leading-tight"
              >
                Privacy Policy: We do not distribute subscriber data. Frequency:
                Monthly dispatches.
              </p>
            </div>
          </div>
        </div>
      </div>
    </section>

    <div class="bg-stone-50 border-t border-stone-300">
      <LeaveNoTrace />
    </div>
  </main>
</Layout>

<style>
  /* Custom serif font fallback for editorial look */
  @font-face {
    font-family: "EditorialSerif";
    src: local("Georgia"), local("Times New Roman"), serif;
  }

  .font-serif {
    font-family: "EditorialSerif", serif;
  }

  /* Grid pattern overlay for that technical field-notes look */
  .bg-grid-subtle {
    background-image: radial-gradient(circle, #d1d5db 1px, transparent 1px);
    background-size: 24px 24px;
  }
</style>
