---
import { Image } from "astro:assets";

import Layout from "@layouts/Layout.astro";
import VolunteerItem from "@components/VolunteerItem.vue";
import LeaveNoTraceSmall from "@components/LeaveNoTraceSmall.astro";
import ContactForm from "@components/ContactForm.vue";
import EmailForm from "@components/EmailForm.vue";
import StaticCalendar from "../components/StaticCalendar.astro";
import SocialLinksInline from "@components/SocialLinksInline.astro";

import { getCollection } from "astro:content";
import { isFuture, endOfDay } from "date-fns";
const upcomingVolunteerEvents = await getCollection("events", ({ data }) => {
  return isFuture(endOfDay(new Date(data.date)));
});

import VolunteerHeroImage from "../assets/images/volunteer-hero-mask.jpg";
import VolunteerInfoImage2 from "../assets/images/volunteer-4.jpg";
import { TURNSTILE_SITE_KEY } from "astro:env/client";

const meetingLocations = await getCollection("trailheads");
---

<Layout title="Volunteer">
  <main class="bg-stone-50 text-stone-900">
    <!-- Hero Section -->
    <section
      class="relative border-b border-stone-300 bg-stone-900 overflow-hidden"
    >
      <Image
        src={VolunteerHeroImage}
        alt="Volunteers in the field"
        class="absolute inset-0 h-full w-full object-cover opacity-40"
        width={1800}
      />
      <div
        class="absolute inset-0 bg-linear-to-t from-stone-900 via-transparent to-transparent"
      >
      </div>

      <div
        class="relative mx-auto max-w-(--breakpoint-2xl) px-4 sm:px-6 lg:px-8 py-24 lg:py-40"
      >
        <div class="max-w-3xl">
          <div class="flex items-center gap-4 mb-8">
            <span class="inline-block h-px w-12 bg-accent"></span>
            <span
              class="font-mono text-[10px] font-black tracking-[0.2em] uppercase text-stone-300"
            >
              How You Can Help
            </span>
          </div>

          <h1
            class="text-5xl sm:text-9xl font-serif font-black tracking-tighter leading-none text-white uppercase"
          >
            Volunteer <br />
            <span class="text-accent">With Us.</span>
          </h1>

          <p
            class="mt-8 text-xl font-medium leading-relaxed text-stone-300 max-w-xl"
          >
            Join our community of dedicated park stewards. We provide the
            expertise and tools; your hands-on help is what makes the continued
            preservation of this urban wildland possible.
          </p>
        </div>
      </div>

      <div class="absolute bottom-0 right-0 p-8 hidden lg:block">
        <div
          class="bg-white/10 backdrop-blur-md border border-white/20 p-6 space-y-4"
        >
          <div class="flex justify-between gap-12">
            <span class="font-mono text-[10px] uppercase text-stone-500"
              >Current Status</span
            >
            <span class="font-mono text-[10px] uppercase text-accent font-black"
              >Recruiting</span
            >
          </div>
          <div class="flex justify-between gap-12">
            <span class="font-mono text-[10px] uppercase text-stone-500"
              >Next Event</span
            >
            <span class="font-mono text-[10px] uppercase text-white font-black">
              {
                upcomingVolunteerEvents.length > 0
                  ? new Date(
                      upcomingVolunteerEvents[0].data.date,
                    ).toLocaleDateString()
                  : "TBD"
              }
            </span>
          </div>
        </div>
      </div>
    </section>

    {
      upcomingVolunteerEvents.length > 0 ? (
        <div class="border border-stone-300 divide-y divide-stone-300">
          {upcomingVolunteerEvents.map((volunteerEvent) => (
            <div class="p-8 hover:bg-stone-50 transition-colors">
              <VolunteerItem
                meetingLocations={meetingLocations}
                volunteerEvent={volunteerEvent}
                client:idle
              />
            </div>
          ))}
        </div>
      ) : (
        <div class="p-12 border border-stone-200 bg-stone-50 text-center">
          <p class="font-mono text-sm uppercase tracking-widest text-stone-600">
            No scheduled events at this time. Check back for seasonal updates.
          </p>
        </div>
      )
    }

    <!-- Volunteer Opportunities -->
    <section class="border-b border-stone-300 bg-white">
      <div class="mx-auto max-w-(--breakpoint-2xl) px-4 sm:px-6 lg:px-8 py-18">
        <div
          class="flex flex-col md:flex-row justify-between items-end gap-8 mb-16"
        >
          <div class="max-w-4xl">
            <h2
              class="text-4xl sm:text-6xl font-serif font-black uppercase tracking-tight text-stone-900 mb-6"
            >
              Volunteer{" "}
              <span class="text-primary-dark italic">Opportunities.</span>
            </h2>
            <p class="text-lg text-stone-600 font-medium leading-relaxed">
              Preserving the 550-acre Ute Valley urban wildland is a collective
              effort. From April through September, we host scheduled trail
              maintenance and stewardship events on select Wednesdays and
              weekends. As our schedule varies each month, we encourage you to
              join our update list and follow us
              <SocialLinksInline /> for the latest news. Whether you join us for one
              session or the full season, your contribution is vital to the health
              of our local trails.
            </p>
          </div>
        </div>
      </div>
    </section>

    <!-- Seasonal Calendar -->
    <section class="py-24 border-b border-stone-300 bg-stone-100/50">
      <StaticCalendar />
    </section>

    <!-- Field Manual / Info -->
    <section class="border-b border-stone-300">
      <div class="mx-auto max-w-(--breakpoint-2xl) px-4 sm:px-6 lg:px-8 py-18">
        <div class="grid grid-cols-1 lg:grid-cols-12 gap-16">
          <div class="lg:col-span-6 space-y-12">
            <div>
              <h2
                class="text-4xl font-serif font-black uppercase tracking-tight text-stone-900 mb-8"
              >
                What to <span class="text-primary-dark italic">Expect.</span>
              </h2>
              <p class="text-lg text-stone-700 leading-relaxed font-medium">
                Our team welcomes individuals of all abilities. We offer tasks
                ranging from trail restoration and drainage construction to
                native seeding and path maintenance.
              </p>
            </div>

            <div class="space-y-6">
              {
                [
                  {
                    title: "Technical Training",
                    desc: "No prior experience required. Crew leaders provide on-site instruction for all specialized tools.",
                  },
                  {
                    title: "Logistics",
                    desc: "FUVP provides all necessary heavy tools and infrastructure support.",
                  },
                  {
                    title: "Field Gear",
                    desc: "Volunteers must wear pants and closed-toe footwear. Gloves and eye protection are mandatory.",
                  },
                ].map((item, i) => (
                  <div class="border-l-4 border-primary-dark pl-6 py-2">
                    <h3 class="font-mono text-sm font-black uppercase tracking-widest text-stone-900 mb-2">
                      0{i + 1}. {item.title}
                    </h3>
                    <p class="text-sm text-stone-600 leading-relaxed font-medium">
                      {item.desc}
                    </p>
                  </div>
                ))
              }
            </div>
          </div>

          <div class="lg:col-span-6 border border-stone-300 bg-white p-4">
            <Image
              src={VolunteerInfoImage2}
              alt="Volunteers in action"
              class="w-full h-auto transition-all duration-1000"
              width={1000}
            />
            <div
              class="mt-4 pt-4 border-t border-stone-100 flex justify-between items-center"
            >
              <span
                class="font-mono text-[10px] uppercase tracking-widest text-stone-500"
                >Volunteers working on trail maintenance</span
              >
            </div>
          </div>
        </div>
      </div>
    </section>

    <!-- Recruitment (Engagement) -->
    <section class="py-24 bg-stone-900 relative overflow-hidden">
      <div
        class="absolute top-0 right-0 w-64 h-64 bg-accent/5 -translate-y-1/2 translate-x-1/2 rotate-45 border border-accent/10"
      >
      </div>

      <div class="mx-auto max-w-6xl px-4 sm:px-6 lg:px-8">
        <div
          class="border-2 border-accent bg-stone-900 p-8 md:p-16 shadow-[16px_16px_0px_0px_var(--color-accent)]"
        >
          <div class="grid grid-cols-1 lg:grid-cols-2 gap-16 items-center">
            <div class="space-y-8">
              <h2
                class="text-4xl font-serif font-black uppercase tracking-tight text-white leading-none"
              >
                Stay <br />
                <span class="text-accent italic">Updated.</span>
              </h2>
              <p class="text-lg text-stone-400 leading-relaxed font-medium">
                Our crew leaders often schedule additional volunteer sessions.
                Stay connected through our newsletter or social media for the
                latest on volunteer opportunities, meeting locations, and park
                updates.
              </p>
            </div>
            <div class="bg-white p-8 border border-stone-300">
              <h3
                class="font-mono text-xs font-black uppercase tracking-widest text-primary-dark mb-6 border-b border-stone-200 pb-2"
              >
                Stay Updated
              </h3>
              <EmailForm client:idle />
              <p
                class="mt-4 text-[10px] font-mono text-stone-500 uppercase leading-tight"
              >
                We respect your privacy. Your email will only be used for
                volunteer updates.
              </p>
            </div>
          </div>
        </div>
      </div>
    </section>

    <!-- Communication Link -->
    <section class="py-24 border-b border-stone-300">
      <div class="mx-auto max-w-7xl px-4 sm:px-6 lg:px-8">
        <ContactForm
          default-option="Volunteer"
          client:visible
          turnstileSiteKey={TURNSTILE_SITE_KEY}
        >
          <Fragment slot="title">
            <h2
              class="text-4xl font-serif font-black uppercase tracking-tight text-stone-900"
            >
              Get in <span class="text-primary-dark italic">Touch.</span>
            </h2>
          </Fragment>
          <Fragment slot="subtitle">
            For specific inquiries regarding group volunteer events or technical
            project coordination, please submit an official request below.
          </Fragment>
        </ContactForm>
      </div>
    </section>

    <div class="bg-stone-50 border-t border-stone-300">
      <LeaveNoTraceSmall />
    </div>
  </main>
</Layout>

<style>
  @font-face {
    font-family: "EditorialSerif";
    src: local("Georgia"), local("Times New Roman"), serif;
  }
  .font-serif {
    font-family: "EditorialSerif", serif;
  }
</style>
