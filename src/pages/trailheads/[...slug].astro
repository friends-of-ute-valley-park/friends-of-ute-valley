---
import { getCollection } from "astro:content";
import Layout from "../../layouts/Layout.astro";
import { Picture } from "astro:assets";
import type { CollectionEntry } from "astro:content";

export async function getStaticPaths() {
  const trailheadEntries = await getCollection("trailheads");
  return trailheadEntries.map((entry) => ({
    params: { slug: entry.id },
    props: { entry },
  }));
}

interface Props {
  entry: CollectionEntry<"trailheads">;
}

const { entry } = Astro.props;
---

<Layout title={entry.data.name}>
  <main class="bg-stone-50 text-stone-900">
    <!-- Trailhead Header -->
    <section class="border-b border-stone-300">
      <div
        class="mx-auto max-w-(--breakpoint-2xl) px-4 sm:px-6 lg:px-8 py-16 lg:py-24"
      >
        <div class="flex items-center gap-4 mb-8">
          <span class="inline-block h-px w-12 bg-primary-dark"></span>
          <span
            class="font-mono text-[10px] font-black tracking-[0.2em] uppercase text-stone-500"
          >
            Trailhead Info
          </span>
        </div>

        <h1
          class="text-6xl sm:text-9xl font-serif font-black tracking-tighter leading-none text-stone-900 uppercase"
        >
          {entry.data.name.split(" ").slice(0, -1).join(" ")}
          <br />
          <span class="text-primary-dark"
            >{entry.data.name.split(" ").slice(-1)}</span
          >
        </h1>

        <p
          class="mt-8 max-w-2xl text-xl font-medium leading-relaxed text-stone-700"
        >
          {entry.data.description}
        </p>
      </div>
    </section>

    <!-- Logistics & Entry Grid -->
    <section class="border-b border-stone-300">
      <div class="mx-auto max-w-(--breakpoint-2xl) px-0 lg:px-8">
        <div class="grid grid-cols-1 lg:grid-cols-12 gap-0">
          <!-- Details -->
          <div
            class="lg:col-span-5 py-16 lg:py-24 px-4 sm:px-6 lg:pr-12 border-r border-stone-300"
          >
            <div class="space-y-12">
              <div>
                <h3
                  class="font-mono text-xs font-black uppercase tracking-widest text-primary-dark border-b border-stone-200 pb-2 mb-6"
                >
                  Location Info
                </h3>
                <p
                  class="text-lg font-medium text-stone-700 leading-relaxed italic"
                >
                  {entry.data.location}
                </p>
              </div>

              <div>
                <h3
                  class="font-mono text-xs font-black uppercase tracking-widest text-primary-dark border-b border-stone-200 pb-2 mb-6"
                >
                  Available Amenities
                </h3>
                <div class="grid grid-cols-1 gap-4">
                  {
                    entry.data.amenities.map((amenity, i) => (
                      <div class="p-6 border border-stone-200 bg-white flex gap-4 items-start">
                        <span class="font-mono text-xs font-black text-accent-dark">
                          [{String(i + 1).padStart(2, "0")}]
                        </span>
                        <div class="space-y-1">
                          <h5 class="text-sm font-bold text-stone-900 uppercase tracking-tight">
                            {amenity.name}
                          </h5>
                          <p class="text-xs text-stone-500 font-medium leading-relaxed">
                            {amenity.description}
                          </p>
                        </div>
                      </div>
                    ))
                  }
                </div>
              </div>

              <div class="pt-8">
                <a
                  href={entry.data.directionsLink}
                  target="_blank"
                  class="btn-primary-cta inline-flex items-center justify-center w-full"
                >
                  Get Directions â†’
                </a>
              </div>
            </div>
          </div>

          <!-- Cartographic Context -->
          <div
            class="lg:col-span-7 bg-stone-100/50 p-8 lg:p-12 flex items-center justify-center"
          >
            <div
              class="w-full max-w-2xl border border-stone-300 bg-white p-4 group"
            >
              <Picture
                class="w-full h-auto transition-all duration-700"
                width="1000"
                src={entry.data.map}
                alt={`${entry.data.name} map section`}
              />
            </div>
          </div>
        </div>
      </div>
    </section>

    <!-- Visual Documentation -->
    <section class="py-24 border-b border-stone-300">
      <div class="mx-auto max-w-(--breakpoint-2xl) px-4 sm:px-6 lg:px-8">
        <div class="mb-16">
          <h2
            class="text-4xl sm:text-6xl font-serif font-black uppercase tracking-tight text-stone-900"
          >
            Site <span class="text-primary-dark italic">Documentation.</span>
          </h2>
        </div>

        <div class="grid grid-cols-1 md:grid-cols-2 gap-12">
          {
            entry.data.photos.map((photo, i) => (
              <div class="space-y-6 group">
                <div class="aspect-16/10 overflow-hidden bg-stone-200 border border-stone-300 relative">
                  <Picture
                    class="w-full h-full object-cover transition-all duration-1000 scale-105 group-hover:scale-100"
                    src={photo.photo}
                    alt={photo.caption}
                    width={800}
                  />
                  <div class="absolute inset-0 border-16 border-white/10 pointer-events-none" />
                </div>
                <p class="font-mono text-[10px] uppercase tracking-widest text-stone-500 text-center font-bold">
                  {photo.caption}
                </p>
              </div>
            ))
          }
        </div>
      </div>
    </section>
  </main>
</Layout>

<style>
  @font-face {
    font-family: "EditorialSerif";
    src: local("Georgia"), local("Times New Roman"), serif;
  }
  .font-serif {
    font-family: "EditorialSerif", serif;
  }
</style>
